!function(){"use strict";function toObject(val){if(null===val||void 0===val)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(val)}var hasOwnProperty=Object.prototype.hasOwnProperty,propIsEnumerable=Object.prototype.propertyIsEnumerable;Object.assign=function(){try{if(!Object.assign)return!1;var test1=new String("abc");if(test1[5]="de","5"===Object.getOwnPropertyNames(test1)[0])return!1;for(var test2={},i=0;i<10;i++)test2["_"+String.fromCharCode(i)]=i;if("0123456789"!==Object.getOwnPropertyNames(test2).map(function(n){return test2[n]}).join(""))return!1;var test3={};return"abcdefghijklmnopqrst".split("").forEach(function(letter){test3[letter]=letter}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},test3)).join("")}catch(e){return!1}}()?Object.assign:function(target,source){for(var from,symbols,to=toObject(target),s=1;s<arguments.length;s++){from=Object(arguments[s]);for(var key in from)hasOwnProperty.call(from,key)&&(to[key]=from[key]);if(Object.getOwnPropertySymbols){symbols=Object.getOwnPropertySymbols(from);for(var i=0;i<symbols.length;i++)propIsEnumerable.call(from,symbols[i])&&(to[symbols[i]]=from[symbols[i]])}}return to}}(),function(global){var docCookies={getItem:function(sKey){return decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent(sKey).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1"))||null},setItem:function(sKey,sValue,vEnd,sPath,sDomain,bSecure){if(!sKey||/^(?:expires|max\-age|path|domain|secure)$/i.test(sKey))return!1;var sExpires="";if(vEnd)switch(vEnd.constructor){case Number:sExpires=vEnd===1/0?"; expires=Fri, 31 Dec 9999 23:59:59 GMT":"; max-age="+vEnd;break;case String:sExpires="; expires="+vEnd;break;case Date:sExpires="; expires="+vEnd.toUTCString()}return document.cookie=encodeURIComponent(sKey)+"="+encodeURIComponent(sValue)+sExpires+(sDomain?"; domain="+sDomain:"")+(sPath?"; path="+sPath:"")+(bSecure?"; secure":""),!0},removeItem:function(sKey,sPath,sDomain){return!(!sKey||!this.hasItem(sKey))&&(document.cookie=encodeURIComponent(sKey)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT"+(sDomain?"; domain="+sDomain:"")+(sPath?"; path="+sPath:""),!0)},hasItem:function(sKey){return new RegExp("(?:^|;\\s*)"+encodeURIComponent(sKey).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=").test(document.cookie)},keys:function(){for(var aKeys=document.cookie.replace(/((?:^|\s*;)[^\=]+)(?=;|$)|^\s*|\s*(?:\=[^;]*)?(?:\1|$)/g,"").split(/\s*(?:\=[^;]*)?;\s*/),nIdx=0;nIdx<aKeys.length;nIdx++)aKeys[nIdx]=decodeURIComponent(aKeys[nIdx]);return aKeys}};window.docCookies=docCookies}(),function(global){function getUtmInfoFromLocationOrStorage(){var info={},keys=["campaign","medium","source","term","content"];if(global.location.search)for(var i=0,len=keys.length;i<len;i++){var key=keys[i];info["utm_"+key]=getQueryString("utm_"+key)}return info}function getQueryString(name){var reg=new RegExp("(|^|&)"+name+"=([^&]*)(&|$)","i"),result=null;return global.location.search&&(result=global.location.search.substr(1).match(reg)),null!=result?unescape(result[2]):""}var timeline,ML_SDK=global.ML,KEYS={updateUtm:"AppMaker.AppUser.UpdateUtm",utmInfo:"AppMaker.AppUser.UtmInfo",appInfo:"AppMaker.AppUser.AppInfo"},DataCollection={_gaSwitch:!1,_utmSwitch:!1,initialize:function(switchInfo){var env=this.distinguishEnvironment(),sdkAccountInfo=this.chooseAccountInfoByEnvironment(env);timeline=new ML_SDK.Timeline(sdkAccountInfo),this.setSwitchInfo(switchInfo),this.saveUTMInfo()},distinguishEnvironment:function(){var hostname=global.location.hostname;return/^file.maxez.cn$/.test(hostname)?getQueryString("env")||"dev":/^(www.maxwon.cn|maxwon.cn)$/.test(hostname)?"prod":/^appuat.maxwon.cn$/.test(hostname)?"uat":/^console.maxez.cn$/.test(hostname)?"maxez":/^wwwdev.leapcloud.cn/.test(hostname)?"dev":/^wwwuat.leapcloud.cn/.test(hostname)?"uat":/^www.leapcloud.cn/.test(hostname)?"prod":"dev"},saveAppInfo:function(info){try{info=JSON.stringify(info),docCookies.setItem(KEYS.appInfo,info,new Date("2099/01/01"),"/")}catch(e){}},destoryAppInfo:function(info){try{docCookies.removeItem(KEYS.appInfo,info,"/")}catch(e){}},getAppInfo:function(){try{var info=docCookies.getItem(KEYS.appInfo);return info=JSON.parse(info)}catch(e){return{}}},chooseAccountInfoByEnvironment:function(env){var origin=window.location.origin;switch(origin=function(origin,env){if(/file.maxez.cn/.test(origin))switch(env){case"dev":return"https://apidev.maxleap.cn";case"uat":return"https://apiuat.maxleap.cn";case"prod":return"https://api.maxleap.cn";default:return"https://apidev.maxleap.cn"}return origin}(origin,env),env){case"dev":return{appId:"57c643039a19d60001e48718",restAPIKey:"amp2UFczRVdMU2t3dFhtNzJzbWlaQQ",serverURL:origin};case"uat":return{appId:"57d221e607698000019558dd",restAPIKey:"MS1jenZoVndxUmYwaHhJalAwOXBiZw",serverURL:origin};case"prod":return{appId:"57c63fa11c5de200059f8d69",restAPIKey:"RVNEeGZuVVJuZC1WR293NTdORnREUQ",serverURL:origin};case"maxez":return{appId:"57d7d0faa2b5ca0007e73d7a",restAPIKey:"ZVZEVVFBakZUNUZ1YnQzek1obm1FZw",serverURL:origin};default:return{appId:"57c63fa11c5de200059f8d69",restAPIKey:"RVNEeGZuVVJuZC1WR293NTdORnREUQ",serverURL:origin}}},setSwitchInfo:function(switchInfo){switchInfo=switchInfo||{},this._gaSwitch=switchInfo.gaSwitch||!1,this._utmSwitch=switchInfo.utmSwitch||!1},saveUTMInfo:function(){if(this._utmSwitch&&!0!==localStorage.getItem(KEYS.updateUtm)){var utmInfo=getUtmInfoFromLocationOrStorage()||{};(utmInfo.utm_campaign||utmInfo.utm_medium||utmInfo.utm_source||utmInfo.utm_term||utmInfo.utm_content)&&(timeline.updateUserInfo(utmInfo).then(function(res){}),localStorage.setItem(KEYS.updateUtm,!0),localStorage.setItem(KEYS.utmInfo,utmInfo))}},monitor:function(eventType,eventInfo,interactionType,url){return this._gaSwitch&&function(eventType,eventInfo,interactionType){ga("send",{hitType:"event",eventCategory:eventType,eventAction:interactionType||"click"})}(eventType,0,interactionType),function(eventType,eventInfo){var timestamp=Date.now(),utmInfo=getUtmInfoFromLocationOrStorage()||{},appInfo=DataCollection.getAppInfo(),params=[{properties:Object.assign({},{_eventType:5,_userAgent:global.navigator.userAgent,get _userId(){return timeline.getUserId()},get appUserId(){return timeline.getInstallationId()},orgUserId:void 0,timestamp:timestamp,_deviceModel:"web"},eventInfo,utmInfo,appInfo),time:timestamp,event:eventType,type:"track",distinct_id:timeline.getDistinctId()}];return timeline.trackEvent(params,{url:url || "2.0/baidu/track/event"})}(eventType,eventInfo)}};"object"==typeof module&&module&&"object"==typeof module.exports?module.exports=DataCollection:(global.DataCollection=DataCollection,"function"==typeof define&&define.amd&&define("DataCollection",[],function(){return DataCollection}))}(window);